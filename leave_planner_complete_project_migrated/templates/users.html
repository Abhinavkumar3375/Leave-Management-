<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>User Management</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    background:#eef2ff; 
    font-family: "Poppins", sans-serif;
}

/* Header */
.page-title{
    font-size:26px;
    font-weight:700;
    color:#2b2b52;
    margin-bottom:20px;
}

/* Card containers */
.card-box{
    background:white;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,0.12);
    padding:20px;
}

/* Tabs */
.nav-tabs .nav-link{
    font-weight:600;
}
.nav-tabs .nav-link.active{
    background:#4e5bff;
    color:white !important;
}

/* Buttons */
.btn-add-user{
    background:linear-gradient(90deg,#4e5bff,#8d42ff);
    border:none;
    color:white;
    font-weight:600;
}
.btn-add-user:hover{ opacity:.9 }

.btn-edit{
    background:#0dcaf0;
    border:none;
}
.btn-edit:hover{ background:#05b5d9 }

.btn-delete{
    background:#e74c3c;
    border:none;
}
.btn-delete:hover{ background:#c0392b }

/* Badges */
.badge-role{
    font-size:.8rem;
    font-weight:600;
}

/* Search bar */
.search-box input{
    border-radius:8px;
    border:1px solid #c9c9ff;
}
.search-box input:focus{
    border-color:#4e5bff;
    box-shadow:0 0 0 0.2rem rgba(78,91,255,.2);
}

/* Table styling */
.table thead{
    background:#e9edff;
    font-weight:600;
}
.table-hover tbody tr:hover{
    background:#f0f4ff;
    transition:0.2s;
}
</style>
</head>

<body class="p-4">

<div class="container">

<!-- Title -->
<div class="page-title">üë• User Management</div>

<!-- Search box -->
<div class="search-box mb-3">
    <input type="text" id="searchInput" class="form-control" placeholder="üîç Search users by name, ID, username...">
</div>

<!-- Tabs -->
<ul class="nav nav-tabs mb-3">
    <li class="nav-item">
        <a class="nav-link active" data-bs-toggle="tab" href="#normalUsers">Users</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-bs-toggle="tab" href="#superUsers">Super Users</a>
    </li>
</ul>

<div class="tab-content">

<!-- Normal Users Tab -->
<div id="normalUsers" class="tab-pane fade show active">

<div class="card-box mb-3">

<!-- Add New User Button -->
<div class="d-flex justify-content-end mb-3">
    <a href="/user/add" class="btn btn-add-user btn-sm">‚ûï Add New User</a>
</div>

<!-- Table -->
<div class="table-responsive">
<table class="table table-hover align-middle" id="userTable">
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Unique ID</th>
<th>Username</th>
<th>Role</th>
<th>Department</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
{% for r in rows %}
{% if r.role != 'superadmin' %}
<tr>
<td>{{r.id}}</td>
<td>{{r.name}}</td>
<td>{{r.unique_id}}</td>
<td>{{r.username}}</td>
<td><span class="badge bg-primary badge-role">{{r.role}}</span></td>
<td>{{r.department}}</td>
<td>
{% if session.role in ['admin','superadmin'] %}
<a class="btn btn-sm btn-edit" href="/user/edit/{{r.id}}">‚úè Edit</a>
<form method="post" action="/user/delete/{{r.id}}" style="display:inline" onsubmit="return confirm('Delete user?');">
<button class="btn btn-sm btn-delete">üóë Delete</button>
</form>
{% endif %}
</td>
</tr>
{% endif %}
{% endfor %}
</tbody>
</table>
</div>

</div>
</div>

<!-- Super Users Tab -->
<div id="superUsers" class="tab-pane fade">

<div class="card-box">

<div class="d-flex justify-content-end mb-3">
    <a href="/user/add?type=superadmin" class="btn btn-add-user btn-sm">‚ú® Create Super User</a>
</div>

<div class="table-responsive">
<table class="table table-hover align-middle">
<thead class="table-warning">
<tr>
<th>ID</th>
<th>Name</th>
<th>Unique ID</th>
<th>Username</th>
<th>Role</th>
<th>Department</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
{% for r in rows %}
{% if r.role == 'superadmin' %}
<tr>
<td>{{r.id}}</td>
<td>{{r.name}}</td>
<td>{{r.unique_id}}</td>
<td>{{r.username}}</td>
<td><span class="badge bg-danger badge-role">SUPER ADMIN</span></td>
<td>{{r.department}}</td>
<td>
<a class="btn btn-sm btn-edit" href="/user/edit/{{r.id}}">‚úè Rename / Password</a>
</td>
</tr>
{% endif %}
{% endfor %}
</tbody>
</table>
</div>

</div>
</div>

</div>

<!-- Back button -->
<a href="/dashboard" class="btn btn-secondary mt-3">‚Üê Back to Dashboard</a>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Simple search filter
document.getElementById("searchInput").addEventListener("keyup", function(){
    let val = this.value.toLowerCase();
    document.querySelectorAll("#userTable tbody tr").forEach(row => {
        row.style.display = row.innerText.toLowerCase().includes(val) ? "" : "none";
    });
});
</script>

</body>
</html>
